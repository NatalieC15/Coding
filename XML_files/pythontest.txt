#importing ElementTree and parsing the XML file
import xml.etree.ElementTree as ET
tree = ET.parse('LRG_16.xml')
root = tree.getroot()

root.attrib
#{'schema_version': '1.9'} - this was the result of looking at the root attribute

for child in root:
     print(child.tag, child.attrib)
#fixed_annotation {}
#updatable_annotation {} - these were both results from looking at the root child relationship

print(ET.tostring(root, encoding='utf8').decode('utf8'))
#output is the tree structure to base further work on

#This is code to find the exon start and end coordinates (after much error, all it takes is an extra /)
#".// - must have 2 /'s to get label information.
start =[]
end = []
label = []
#creation of lists
for exon in root.findall(".//fixed_annotation/transcript/exon"):
	label.append(exon.get('label'))
	coordinates = exon.find('coordinates')
	start.append(coordinates.get('start'))
	end.append(coordinates.get('end'))

##Use the print function to test the list creation for label, start and end
#print (label, start, end)

#Finding the chromosome number, start and end coordinates within the XML file, this finds the build number GRCh37.p13. May not converse for every file.
#May need to find a way to pull only the GRCh37 build in the future. 
for annotation_set in root.findall(".//updatable_annotation/annotation_set[@type='lrg']"):
	mapping = annotation_set.find('mapping')
	chrom = mapping.get('other_name')
	chromstart = mapping.get('other_start')
	chromend = mapping.get('other_end')

##Use the print function to test the at the correct values for chromosome number, genomic start and end coordinates.
#print(chrom, chromstart, chromend)

#Code to extract the gene name
for annotation_set in root.findall(".//updatable_annotation/annotation_set[@type='lrg']"):
     lrg_locus = annotation_set.find('lrg_locus')
     print(lrg_locus.text)

#Creation of the .bed file
f = open("lrg.bed", "w")
f.write("Chrom" + "\t" + "Start" + "\t" + "End" + "\n")
for i in range(len(start)):
	f.write(str(chrom) + "\t" + str(start[i]) + "\t" + str(end[i]) + "\n")

f.close()